= Schulungsumgebung in AWS

Wir bauen X Schulungsumgebungen in AWS auf.

Es wird terraform verwendet, um eine isolierte Umgebung zu erstellen.

Danach wird ansible verwendet, um die VMs für das Training einzurichten.

== Terraform

Für den Aufbau der Schulungsumgebung gibt es ein eigenes https://github.com/Gepardec/train[Git Repository] und https://github.com/Gepardec/train/pkgs/container/train[Images] welches Terraform verwendet.
https://gepardec.github.io/train/[Github Pages] liefert die Dokumentation.

Ein passender ami_name kann in https://eu-central-1.console.aws.amazon.com/ec2/home?region=eu-central-1#Images:visibility=public-images;imageName=:Fedora-Cloud-Base-AmazonEC2.x86_64;v=3;$case=tags:false%5C,client:false;$regex=tags:false%5C,client:false[aws] gefunden werden.


=== Installation
Zuerst müssen die AWS Resourcen erstellt werden:
[source,shell]
----
podman run --rm -it -v $HOME/.aws:/root/.aws:ro -v $(pwd)/:/opt/train/workdir ghcr.io/gepardec/train:latest apply
----
Danach können die Maschinen konfiguriert werden:
[source,shell]
----
ansible-galaxy collection install -r requirements.yml
ansible-playbook -i troubleshooting-workshop/inventory --tags execute playbook.yaml --start-at-task="Disable SELinux"
----

=== Verbinden mit Weptop
In der Datei `troubleshooting-workshop/readme.txt` stehen die Verbindungsdaten zu Webtop.

=== Deinstallation und Cleanup
AWS Resourcen löschen:
[source,shell]
----
podman run --rm -it -v $HOME/.aws:/root/.aws:ro -v $(pwd)/:/opt/train/workdir ghcr.io/gepardec/train:latest destroy
----
Cleanup Lokal:

[source,shell]
----
rm -r troubleshooting-workshop
----
